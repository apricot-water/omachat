<!DOCTYPE html>
<html lang="de">
<head>
<script src="../../isolation.js"></script>  
    <meta charset="UTF-8">
    <title>Pro 3-Way Diff & Merge</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css">
    <style>
        body { font-family: sans-serif; margin: 0; padding: 20px; background-color: #f0f2f5; }
        .setup-container { display: flex; gap: 15px; margin-bottom: 20px; }
        .panel { flex: 1; background: #fff; padding: 15px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); display: flex; flex-direction: column; }
        h3 { margin-top: 0; font-size: 14px; color: #555; text-transform: uppercase; }
        textarea { width: 100%; height: 200px; margin-top: 10px; font-family: monospace; border: 1px solid #ccc; border-radius: 4px; resize: vertical; }
        .file-input { margin-top: 10px; font-size: 12px; }
        .controls { text-align: center; padding: 20px; }
        button { padding: 15px 40px; background-color: #007bff; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; font-size: 16px; }
        button:hover { background-color: #0056b3; }
        .diff-section { margin-top: 30px; background: white; border-radius: 8px; padding: 10px; }
        .diff-label { background: #333; color: white; padding: 5px 15px; border-radius: 4px 4px 0 0; font-size: 13px; display: inline-block; }
    </style>
</head>
<body>

    <div class="setup-container">
        <!-- VERSION A -->
        <div class="panel">
            <h3>Version A (Deine Änderungen)</h3>
            <input type="file" class="file-input" onchange="loadFile(this, 'textA')">
            <textarea id="textA" placeholder="Code A hier rein oder Datei laden..."></textarea>
        </div>

        <!-- BASE -->
        <div class="panel" style="background-color: #e9ecef;">
            <h3>Base (Gemeinsamer Vorfahre)</h3>
            <input type="file" class="file-input" onchange="loadFile(this, 'textBase')">
            <textarea id="textBase" placeholder="Original-Basis hier rein oder Datei laden..."></textarea>
        </div>

        <!-- VERSION B -->
        <div class="panel">
            <h3>Version B (Kollegen Änderungen)</h3>
            <input type="file" class="file-input" onchange="loadFile(this, 'textB')">
            <textarea id="textB" placeholder="Code B hier rein oder Datei laden..."></textarea>
        </div>
    </div>

    <div class="controls">
        <button id="compare-btn">3-Way Vergleich starten</button>
    </div>

    <div id="output-A" class="diff-section"></div>
    <div id="output-B" class="diff-section"></div>

    <script src="https://cdn.jsdelivr.net/npm/diff/dist/diff.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html.min.js"></script>

    <script>
        // Funktion zum Laden von Dateien
        function loadFile(input, targetId) {
            const file = input.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = function(e) {
                document.getElementById(targetId).value = e.target.result;
            };
            reader.readAsText(file);
        }

        document.getElementById('compare-btn').addEventListener('click', function() {
            const txtA = document.getElementById('textA').value;
            const txtBase = document.getElementById('textBase').value;
            const txtB = document.getElementById('textB').value;

            // Vergleich 1: Base vs A
            const patchA = Diff.createPatch("Änderungen in A", txtBase, txtA);
            const htmlA = Diff2Html.html(patchA, {
                drawFileList: false, matching: 'lines', outputFormat: 'side-by-side', synchronisedScroll: true
            });
            document.getElementById('output-A').innerHTML = '<div class="diff-label">Vergleich: Basis <-> Version A</div>' + htmlA;

            // Vergleich 2: Base vs B
            const patchB = Diff.createPatch("Änderungen in B", txtBase, txtB);
            const htmlB = Diff2Html.html(patchB, {
                drawFileList: false, matching: 'lines', outputFormat: 'side-by-side', synchronisedScroll: true
            });
            document.getElementById('output-B').innerHTML = '<div class="diff-label">Vergleich: Basis <-> Version B</div>' + htmlB;
        });
    </script>
</body>
</html>
